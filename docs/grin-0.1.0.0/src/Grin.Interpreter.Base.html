<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase, GeneralizedNewtypeDeriving, InstanceSigs, TypeFamilies, TemplateHaskell, ScopedTypeVariables, DataKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Grin.Interpreter.Base</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><a href="Grin.Interpreter.Base.html"><span class="hs-identifier">Grin.Interpreter.Base</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Fail</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Function</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fix</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.Exp.html"><span class="hs-identifier">Grin.Exp</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.Value.html"><span class="hs-identifier">Grin.Value</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-type">Val</span></a><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.Interpreter.Env.html"><span class="hs-identifier">Grin.Interpreter.Env</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Grin.Interpreter.Env.html"><span class="hs-identifier">Grin.Interpreter.Env</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Env</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Grin.Value.html"><span class="hs-identifier">Grin.Value</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Grin</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">-- * Interpreter</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-identifier">eval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Interpreter"><span class="hs-identifier hs-type">Interpreter</span></a><span> </span><a href="#local-6989586621679177984"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679177984"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177985"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">v</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177984"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Grin.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177984"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679177985"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-21"></a><a name="eval"><a href="Grin.Interpreter.Base.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fix</span><span> </span><a href="Grin.Interpreter.Base.html#baseEval"><span class="hs-identifier hs-var">baseEval</span></a><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-- Open recursion and monadic interpreter.</span><span>
</span><a name="line-24"></a><span class="hs-identifier">baseEval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadIO</span><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><a href="Grin.Interpreter.Base.html#Interpreter"><span class="hs-identifier hs-type">Interpreter</span></a><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">a</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Grin.Interpreter.Base.html#Addr"><span class="hs-identifier hs-type">Addr</span></a><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">v</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679177961"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Grin.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177959"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><a name="baseEval"><a href="Grin.Interpreter.Base.html#baseEval"><span class="hs-identifier">baseEval</span></a></a><span> </span><a name="local-6989586621679177986"><a href="#local-6989586621679177986"><span class="hs-identifier">ev0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><a name="line-27"></a><span>  </span><a href="Grin.Exp.html#SPure"><span class="hs-identifier hs-var">SPure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Grin.Val</span></a><span> </span><a name="local-6989586621679177987"><a href="#local-6989586621679177987"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Grin.Interpreter.Base.html#value"><span class="hs-identifier hs-var">value</span></a><span> </span><a href="#local-6989586621679177987"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-28"></a><span>  </span><a href="Grin.Exp.html#SPure"><span class="hs-identifier hs-var">SPure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679177988"><a href="#local-6989586621679177988"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-29"></a><span>    </span><a name="local-6989586621679177989"><a href="#local-6989586621679177989"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-30"></a><span>    </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679177989"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679177988"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>  </span><a href="Grin.Exp.html#SApp"><span class="hs-identifier hs-var">SApp</span></a><span> </span><a name="local-6989586621679177990"><a href="#local-6989586621679177990"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679177991"><a href="#local-6989586621679177991"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-33"></a><span>    </span><a name="local-6989586621679177992"><a href="#local-6989586621679177992"><span class="hs-identifier">p</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-34"></a><span>    </span><a name="local-6989586621679177993"><a href="#local-6989586621679177993"><span class="hs-identifier">vs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679177992"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177991"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-35"></a><span>    </span><a name="local-6989586621679177994"><a href="#local-6989586621679177994"><span class="hs-identifier">ex</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#isExternal"><span class="hs-identifier hs-var">isExternal</span></a><span> </span><a href="#local-6989586621679177990"><span class="hs-identifier hs-var">fn</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679177994"><span class="hs-identifier hs-var">ex</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Grin.Interpreter.Base.html#external"><span class="hs-identifier hs-var">external</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Grin.Interpreter.Base.html#funCall"><span class="hs-identifier hs-var">funCall</span></a><span> </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679177990"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679177993"><span class="hs-identifier hs-var">vs</span></a><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>  </span><a href="Grin.Exp.html#SFetch"><span class="hs-identifier hs-var">SFetch</span></a><span> </span><a name="local-6989586621679177995"><a href="#local-6989586621679177995"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-39"></a><span>    </span><a name="local-6989586621679177996"><a href="#local-6989586621679177996"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679177997"><a href="#local-6989586621679177997"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679177996"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679177995"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-41"></a><span>    </span><a href="Grin.Interpreter.Base.html#fetchStore"><span class="hs-identifier hs-var">fetchStore</span></a><span> </span><a href="#local-6989586621679177997"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>  </span><a href="Grin.Exp.html#SUpdate"><span class="hs-identifier hs-var">SUpdate</span></a><span> </span><a name="local-6989586621679177998"><a href="#local-6989586621679177998"><span class="hs-identifier">nl</span></a></a><span> </span><a name="local-6989586621679177999"><a href="#local-6989586621679177999"><span class="hs-identifier">nn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-44"></a><span>    </span><a name="local-6989586621679178000"><a href="#local-6989586621679178000"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679178001"><a href="#local-6989586621679178001"><span class="hs-identifier">vl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679178000"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679177998"><span class="hs-identifier hs-var">nl</span></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679178002"><a href="#local-6989586621679178002"><span class="hs-identifier">vn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679178000"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679177999"><span class="hs-identifier hs-var">nn</span></a><span>
</span><a name="line-47"></a><span>    </span><a href="Grin.Interpreter.Base.html#extStore"><span class="hs-identifier hs-var">extStore</span></a><span> </span><a href="#local-6989586621679178001"><span class="hs-identifier hs-var">vl</span></a><span> </span><a href="#local-6989586621679178002"><span class="hs-identifier hs-var">vn</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-keyword">unit</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span>  </span><a href="Grin.Exp.html#ECase"><span class="hs-identifier hs-var">ECase</span></a><span> </span><a name="local-6989586621679178003"><a href="#local-6989586621679178003"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679178004"><a href="#local-6989586621679178004"><span class="hs-identifier">alts</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-51"></a><span>    </span><a name="local-6989586621679178005"><a href="#local-6989586621679178005"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-52"></a><span>    </span><a name="local-6989586621679178006"><a href="#local-6989586621679178006"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679178005"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679178003"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- Select the alternative and continue the evaluation</span><span>
</span><a name="line-54"></a><span>    </span><a href="Grin.Interpreter.Base.html#evalCase"><span class="hs-identifier hs-var">evalCase</span></a><span> </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178006"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679178004"><span class="hs-identifier hs-var">alts</span></a><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>  </span><a href="Grin.Exp.html#EBind"><span class="hs-identifier hs-var">EBind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#SStore"><span class="hs-identifier hs-var">SStore</span></a><span> </span><a name="local-6989586621679178007"><a href="#local-6989586621679178007"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><a name="local-6989586621679178008"><a href="#local-6989586621679178008"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679178009"><a href="#local-6989586621679178009"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-57"></a><span>    </span><a name="local-6989586621679178010"><a href="#local-6989586621679178010"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679178011"><a href="#local-6989586621679178011"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Grin.Interpreter.Env.html#lookup"><span class="hs-identifier hs-var">Env.lookup</span></a><span> </span><a href="#local-6989586621679178010"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679178007"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-59"></a><span>    </span><a name="local-6989586621679178012"><a href="#local-6989586621679178012"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#allocStore"><span class="hs-identifier hs-var">allocStore</span></a><span> </span><a href="#local-6989586621679178008"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-60"></a><span>    </span><a href="Grin.Interpreter.Base.html#extStore"><span class="hs-identifier hs-var">extStore</span></a><span> </span><a href="#local-6989586621679178012"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679178011"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679178013"><a href="#local-6989586621679178013"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Grin.Interpreter.Env.html#insert"><span class="hs-identifier hs-var">Env.insert</span></a><span> </span><a href="#local-6989586621679178008"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679178012"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679178010"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-62"></a><span>    </span><a href="Grin.Interpreter.Base.html#localEnv"><span class="hs-identifier hs-var">localEnv</span></a><span> </span><a href="#local-6989586621679178013"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178009"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span>  </span><a href="Grin.Exp.html#EBind"><span class="hs-identifier hs-var">EBind</span></a><span> </span><a name="local-6989586621679178014"><a href="#local-6989586621679178014"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><a name="local-6989586621679178015"><a href="#local-6989586621679178015"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679178016"><a href="#local-6989586621679178016"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-65"></a><span>    </span><a name="local-6989586621679178017"><a href="#local-6989586621679178017"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178014"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-66"></a><span>    </span><a name="local-6989586621679178018"><a href="#local-6989586621679178018"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679178019"><a href="#local-6989586621679178019"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Grin.Interpreter.Env.html#insert"><span class="hs-identifier hs-var">Env.insert</span></a><span> </span><a href="#local-6989586621679178015"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679178017"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679178018"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-68"></a><span>    </span><a href="Grin.Interpreter.Base.html#localEnv"><span class="hs-identifier hs-var">localEnv</span></a><span> </span><a href="#local-6989586621679178019"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178016"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>  </span><a href="Grin.Exp.html#EBind"><span class="hs-identifier hs-var">EBind</span></a><span> </span><a name="local-6989586621679178020"><a href="#local-6989586621679178020"><span class="hs-identifier">lhs</span></a></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span> </span><a name="local-6989586621679178021"><a href="#local-6989586621679178021"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679178022"><a href="#local-6989586621679178022"><span class="hs-identifier">vs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679178023"><a href="#local-6989586621679178023"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-71"></a><span>    </span><a name="local-6989586621679178024"><a href="#local-6989586621679178024"><span class="hs-identifier">v</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178020"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-72"></a><span>    </span><a name="local-6989586621679178025"><a href="#local-6989586621679178025"><span class="hs-identifier">p</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier hs-var">askEnv</span></a><span>
</span><a name="line-73"></a><span>    </span><a name="local-6989586621679178026"><a href="#local-6989586621679178026"><span class="hs-identifier">p'</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Grin.Interpreter.Env.html#inserts"><span class="hs-identifier hs-var">Env.inserts</span></a><span> </span><a href="#local-6989586621679178025"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Grin.Interpreter.Base.html#bindPattern"><span class="hs-identifier hs-var">bindPattern</span></a><span> </span><a href="#local-6989586621679178024"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679178021"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><a href="#local-6989586621679178022"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>    </span><a href="Grin.Interpreter.Base.html#localEnv"><span class="hs-identifier hs-var">localEnv</span></a><span> </span><a href="#local-6989586621679178026"><span class="hs-identifier hs-var">p'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178023"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>  </span><a href="Grin.Exp.html#EBind"><span class="hs-identifier hs-var">EBind</span></a><span> </span><a name="local-6989586621679178027"><a href="#local-6989586621679178027"><span class="hs-identifier">lhs</span></a></a><span> </span><a href="Grin.Exp.html#BUnit"><span class="hs-identifier hs-var">BUnit</span></a><span> </span><a name="local-6989586621679178028"><a href="#local-6989586621679178028"><span class="hs-identifier">rhs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178027"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-78"></a><span>    </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178028"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>  </span><a href="Grin.Exp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><a name="local-6989586621679178029"><a href="#local-6989586621679178029"><span class="hs-identifier">_pat</span></a></a><span> </span><a name="local-6989586621679178030"><a href="#local-6989586621679178030"><span class="hs-identifier">body</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-81"></a><span>    </span><a href="#local-6989586621679177986"><span class="hs-identifier hs-var">ev0</span></a><span> </span><a href="#local-6989586621679178030"><span class="hs-identifier hs-var">body</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>  </span><a name="local-6989586621679178031"><a href="#local-6989586621679178031"><span class="hs-identifier">overGenerative</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679178031"><span class="hs-identifier hs-var">overGenerative</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- Type class</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadFail</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Interpreter"><a href="Grin.Interpreter.Base.html#Interpreter"><span class="hs-identifier">Interpreter</span></a></a><span> </span><a name="local-6989586621679177958"><a href="#local-6989586621679177958"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-keyword">type</span><span> </span><a name="Val"><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier">Val</span></a></a><span>     </span><a name="local-6989586621679177958"><a href="#local-6989586621679177958"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-comment">-- Values that can be placed in registers/variables</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-keyword">type</span><span> </span><a name="HeapVal"><a href="Grin.Interpreter.Base.html#HeapVal"><span class="hs-identifier">HeapVal</span></a></a><span> </span><a name="local-6989586621679177958"><a href="#local-6989586621679177958"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-comment">-- Values for the Store, Fetch, Update parameters</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-keyword">type</span><span> </span><a name="Addr"><a href="Grin.Interpreter.Base.html#Addr"><span class="hs-identifier">Addr</span></a></a><span>    </span><a name="local-6989586621679177958"><a href="#local-6989586621679177958"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-comment">-- A type to represent an Address</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">-- Conversions, but m type is needed for type inference</span><span>
</span><a name="line-93"></a><span>  </span><a name="value"><a href="Grin.Interpreter.Base.html#value"><span class="hs-identifier">value</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Value.html#Value"><span class="hs-identifier hs-type">Grin.Value</span></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Value of the given literal</span><span>
</span><a name="line-94"></a><span>  </span><a name="val2addr"><a href="Grin.Interpreter.Base.html#val2addr"><span class="hs-identifier">val2addr</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Addr"><span class="hs-identifier hs-type">Addr</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">--</span><span>
</span><a name="line-95"></a><span>  </span><a name="addr2val"><a href="Grin.Interpreter.Base.html#addr2val"><span class="hs-identifier">addr2val</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#Addr"><span class="hs-identifier hs-type">Addr</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>  </span><a name="heapVal2val"><a href="Grin.Interpreter.Base.html#heapVal2val"><span class="hs-identifier">heapVal2val</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#HeapVal"><span class="hs-identifier hs-type">HeapVal</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>  </span><a name="val2heapVal"><a href="Grin.Interpreter.Base.html#val2heapVal"><span class="hs-identifier">val2heapVal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#HeapVal"><span class="hs-identifier hs-type">HeapVal</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-keyword">unit</span><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- The unit value</span><span>
</span><a name="line-99"></a><span>  </span><a name="bindPattern"><a href="Grin.Interpreter.Base.html#bindPattern"><span class="hs-identifier">bindPattern</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">,</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-comment">-- Non-pure</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>  </span><span class="hs-comment">-- | Return the computational environment</span><span>
</span><a name="line-104"></a><span>  </span><a name="askEnv"><a href="Grin.Interpreter.Base.html#askEnv"><span class="hs-identifier">askEnv</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-comment">-- | Set the local environment</span><span>
</span><a name="line-106"></a><span>  </span><a name="localEnv"><a href="Grin.Interpreter.Base.html#localEnv"><span class="hs-identifier">localEnv</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>  </span><a name="lookupFun"><a href="Grin.Interpreter.Base.html#lookupFun"><span class="hs-identifier">lookupFun</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Grin.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-108"></a><span>  </span><a name="isExternal"><a href="Grin.Interpreter.Base.html#isExternal"><span class="hs-identifier">isExternal</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-109"></a><span>  </span><a name="external"><a href="Grin.Interpreter.Base.html#external"><span class="hs-identifier">external</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>  </span><span class="hs-comment">-- Control-flow</span><span>
</span><a name="line-112"></a><span>  </span><a name="evalCase"><a href="Grin.Interpreter.Base.html#evalCase"><span class="hs-identifier">evalCase</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Grin.Exp.html#Alt"><span class="hs-identifier hs-type">Alt</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>  </span><a name="funCall"><a href="Grin.Interpreter.Base.html#funCall"><span class="hs-identifier">funCall</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-comment">-- Store</span><span>
</span><a name="line-116"></a><span>  </span><a name="allocStore"><a href="Grin.Interpreter.Base.html#allocStore"><span class="hs-identifier">allocStore</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Value.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>  </span><a name="fetchStore"><a href="Grin.Interpreter.Base.html#fetchStore"><span class="hs-identifier">fetchStore</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- TODO: Change this to Addr m??</span><span>
</span><a name="line-118"></a><span>  </span><a name="extStore"><a href="Grin.Interpreter.Base.html#extStore"><span class="hs-identifier">extStore</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Grin.Interpreter.Base.html#Val"><span class="hs-identifier hs-type">Val</span></a><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679177958"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-119"></a></pre></body></html>