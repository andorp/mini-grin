<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Grin.Examples</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.Value.html"><span class="hs-identifier">Grin.Value</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Grin.Value.html#VarOrValue"><span class="hs-identifier hs-type">VarOrValue</span></a><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#TagType"><span class="hs-identifier hs-type">TagType</span></a><span class="hs-special">(</span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span class="hs-special">,</span><a href="Grin.Value.html#F"><span class="hs-identifier hs-var">F</span></a><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-type">Node</span></a><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#Value"><span class="hs-identifier hs-type">Value</span></a><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Value.html#SimpleValue"><span class="hs-identifier hs-type">SimpleValue</span></a><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span class="hs-special">,</span><a href="Grin.Value.html#SBool"><span class="hs-identifier hs-var">SBool</span></a><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.TypeEnv.html"><span class="hs-identifier">Grin.TypeEnv</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Grin.TypeEnv.html#SimpleType"><span class="hs-identifier hs-type">SimpleType</span></a><span class="hs-special">(</span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#T_Bool"><span class="hs-identifier hs-var">T_Bool</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#T_Unit"><span class="hs-identifier hs-var">T_Unit</span></a><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#Ty"><span class="hs-identifier hs-type">Ty</span></a><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.Exp.html"><span class="hs-identifier">Grin.Exp</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-type">External</span></a><span class="hs-special">(</span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#BPat"><span class="hs-identifier hs-type">BPat</span></a><span class="hs-special">(</span><a href="Grin.Exp.html#BUnit"><span class="hs-identifier hs-var">BUnit</span></a><span class="hs-special">,</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span class="hs-special">,</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#CPat"><span class="hs-identifier hs-type">CPat</span></a><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Grin.GExp.html"><span class="hs-identifier">Grin.GExp</span></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Grin.GExp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">(</span><a href="Grin.GExp.html#Program"><span class="hs-identifier hs-var">Program</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Case"><span class="hs-identifier hs-var">Case</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Fetch"><span class="hs-identifier hs-var">Fetch</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Update"><span class="hs-identifier hs-var">Update</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span class="hs-special">,</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#ExpCtx"><span class="hs-identifier hs-type">ExpCtx</span></a><span class="hs-special">(</span><a href="Grin.GExp.html#Prg"><span class="hs-identifier hs-var">Prg</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-comment">-- * Test expression</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">{-
primop pure
  prim_int_add :: T_Int64 -&gt; T_Int64 -&gt; T_Int64

add s1 s2 =
  s3 &lt;- prim_int_add $ s1 s2
  pure s3

main =
  m1 &lt;- pure 10
  m2 &lt;- pure 20
  add $ m1 m2
-}</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-identifier">add</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Grin.GExp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">'</span><a href="Grin.GExp.html#Prg"><span class="hs-identifier hs-type">Prg</span></a><span>
</span><a name="line-46"></a><a name="add"><a href="Grin.Examples.html#add"><span class="hs-identifier">add</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-47"></a><span>  </span><a href="Grin.GExp.html#Program"><span class="hs-identifier hs-var">Program</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-comment">-- type signatures of external functions must be provided at the top of teh module</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_add&quot;</span><span> </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;add&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;s2&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-52"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_add&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;s2&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;s3&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-53"></a><span>        </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;s3&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;main&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-55"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m1&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-56"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">20</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-57"></a><span>        </span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;add&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- * Factorial</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{-
prim_int_sub :: T_Int64 -&gt; T_Int64 -&gt; T_Int64
prim_int_mul :: T_Int64 -&gt; T_Int64 -&gt; T_Int64
prim_int_eq :: T_Int64 -&gt; T_Int64 -&gt; T_Bool
prim_int_print :: T_Int64 -&gt; T_Int64 -&gt; T_Unit

fact f1 =
  f2 &lt;- pure 0
  f3 &lt;- prim_int_eq $ f1 f2
  case f3 of
    #True -&gt;
      f7 &lt;- pure 1
      pure f7
    #False -&gt;
      f4 &lt;- pure 1
      f5 &lt;- prim_int_sub $ f1 f4
      f6 &lt;- fact $ f5
      prim_int_mul $ f1 f6

main =
  m1 &lt;- pure 10
  m2 &lt;- fact $ m1
  prim_int_print $ m2
  pure m2
-}</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">fact</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Grin.GExp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">'</span><a href="Grin.GExp.html#Prg"><span class="hs-identifier hs-type">Prg</span></a><span>
</span><a name="line-89"></a><a name="fact"><a href="Grin.Examples.html#fact"><span class="hs-identifier">fact</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>  </span><a href="Grin.GExp.html#Program"><span class="hs-identifier hs-var">Program</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_sub&quot;</span><span>   </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_mul&quot;</span><span>   </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_eq&quot;</span><span>    </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Bool"><span class="hs-identifier hs-var">T_Bool</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_print&quot;</span><span> </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Unit"><span class="hs-identifier hs-var">T_Unit</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;fact&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;f1&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-97"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;f2&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-98"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_eq&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;f1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;f2&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;f3&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-99"></a><span>        </span><a href="Grin.GExp.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><span class="hs-string">&quot;f3&quot;</span><span>
</span><a name="line-100"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SBool"><span class="hs-identifier hs-var">SBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-101"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;f7&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-102"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;f7&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SBool"><span class="hs-identifier hs-var">SBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-104"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;f4&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-105"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_sub&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;f1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;f4&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;f5&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-106"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;fact&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;f5&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;f6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-107"></a><span>                </span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_mul&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;f1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;f6&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;main&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-110"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m1&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-111"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;fact&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m1&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-112"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_print&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="Grin.Exp.html#BUnit"><span class="hs-identifier hs-var">BUnit</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-113"></a><span>        </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- * Sum simple</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">{-
prim_int_add :: T_Int64 -&gt; T_Int64 -&gt; T_Int64
prim_int_sub :: T_Int64 -&gt; T_Int64 -&gt; T_Int64
prim_int_eq :: T_Int64 -&gt; T_Int64 -&gt; T_Bool
prim_int_gt :: T_Int64 -&gt; T_Int64 -&gt; T_Bool
prim_int_print :: T_Int64 -&gt; T_Int64 -&gt; T_Unit

main =
  m1 &lt;- pure 1
  m2 &lt;- pure 100
  m3 &lt;- pure (CInt m1)
  m4 &lt;- pure (CInt m2)
  m5 &lt;- store m3
  m6 &lt;- store m4
  m7 &lt;- pure (Fupto m5 m6)
  m8 &lt;- store m7
  m9 &lt;- pure (Fsum m8)
  m10 &lt;- store m9
  (CInt m11) &lt;- eval $ m10
  prim_int_print $ m11

upto u1 u2 =
  (CInt u3) &lt;- eval $ u1
  (CInt u4) &lt;- eval $ u2
  u5 &lt;- prim_int_gt $ u3 u4
  case u5 of
    #True -&gt;
      u12 &lt;- pure (CNil)
      pure u12
    #False -&gt;
      u6 &lt;- pure 1
      u7 &lt;- prim_int_add $ u3 u6
      u8 &lt;- pure (CInt u7)
      u9 &lt;- store u8
      u10 &lt;- pure (Fupto u9 u2)
      u11 &lt;- store u10
      pure (CCons u1 u11)

sum s1 =
  s2 &lt;- eval $ s1
  case s2 of
    (CNil) -&gt;
      s3 &lt;- pure 0
      pure (CInt s3)
    (CCons s5 s6) -&gt;
      (CInt s7) &lt;- eval $ s5
      (CInt s8) &lt;- sum $ s6
      s9 &lt;- prim_int_add $ s7 s8
      pure (CInt s9)

eval e1 =
  e2 &lt;- fetch e1
  case e2 of
    (CInt e3) -&gt;
      e11 &lt;- pure (CInt e3)
      pure e11
    (CNil) -&gt;
      e12 &lt;- pure (CNil)
      pure e12
    (CCons e4 e5) -&gt;
      e13 &lt;- pure (CCons e4 e5)
      pure e13
    (Fupto e6 e7) -&gt;
      e8 &lt;- upto $ e6 e7
      update e1 e8
      pure e8
    (Fsum e9) -&gt;
      e10 &lt;- sum $ e9
      update e1 e10
      pure e10
-}</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-identifier">sumSimple</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Grin.GExp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">'</span><a href="Grin.GExp.html#Prg"><span class="hs-identifier hs-type">Prg</span></a><span>
</span><a name="line-191"></a><a name="sumSimple"><a href="Grin.Examples.html#sumSimple"><span class="hs-identifier">sumSimple</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-192"></a><span>  </span><a href="Grin.GExp.html#Program"><span class="hs-identifier hs-var">Program</span></a><span>
</span><a name="line-193"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_add&quot;</span><span>   </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_sub&quot;</span><span>   </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_eq&quot;</span><span>    </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Bool"><span class="hs-identifier hs-var">T_Bool</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_gt&quot;</span><span>    </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Bool"><span class="hs-identifier hs-var">T_Bool</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.Exp.html#External"><span class="hs-identifier hs-var">External</span></a><span> </span><span class="hs-string">&quot;prim_int_print&quot;</span><span> </span><span class="hs-special">(</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Unit"><span class="hs-identifier hs-var">T_Unit</span></a><span class="hs-special">)</span><span>   </span><span class="hs-special">[</span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">,</span><span> </span><a href="Grin.TypeEnv.html#TySimple"><span class="hs-identifier hs-var">TySimple</span></a><span> </span><a href="Grin.TypeEnv.html#T_Int64"><span class="hs-identifier hs-var">T_Int64</span></a><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;main&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-200"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m1&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-201"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-202"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m1&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m3&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-203"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m2&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m4&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-204"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span> </span><span class="hs-string">&quot;m3&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m5&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-205"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span> </span><span class="hs-string">&quot;m4&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-206"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-string">&quot;upto&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m5&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;m6&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m7&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-207"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span> </span><span class="hs-string">&quot;m7&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m8&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-208"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-string">&quot;sum&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m8&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m9&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-209"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span> </span><span class="hs-string">&quot;m9&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;m10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-210"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;eval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m10&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m11&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-211"></a><span>        </span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_print&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;m11&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;upto&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u2&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-213"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;eval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u1&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u3&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-214"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;eval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u2&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u4&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-215"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_gt&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u3&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u4&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u5&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-216"></a><span>        </span><a href="Grin.GExp.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><span class="hs-string">&quot;u5&quot;</span><span>
</span><a name="line-217"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SBool"><span class="hs-identifier hs-var">SBool</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-218"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Nil&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u12&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-219"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;u12&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SBool"><span class="hs-identifier hs-var">SBool</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-221"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u6&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-222"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_add&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u3&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u6&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u7&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-223"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u7&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u8&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-224"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span> </span><span class="hs-string">&quot;u8&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u9&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-225"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-string">&quot;upto&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u9&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u2&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-226"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Store"><span class="hs-identifier hs-var">Store</span></a><span> </span><span class="hs-string">&quot;u10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;u11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-227"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Cons&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;u1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u11&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;sum&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s1&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-230"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;eval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s1&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;s2&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-231"></a><span>        </span><a href="Grin.GExp.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><span class="hs-string">&quot;s2&quot;</span><span>
</span><a name="line-232"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Nil&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-233"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VPrim"><span class="hs-identifier hs-var">VPrim</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;s3&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-234"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s3&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Cons&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s5&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;s6&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-236"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;eval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s5&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s7&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-237"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;sum&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s6&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BNodePat"><span class="hs-identifier hs-var">BNodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s8&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-238"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;prim_int_add&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s7&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;s8&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;s9&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-239"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;s9&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Def"><span class="hs-identifier hs-var">Def</span></a><span> </span><span class="hs-string">&quot;eval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e1&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-242"></a><span>        </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Fetch"><span class="hs-identifier hs-var">Fetch</span></a><span> </span><span class="hs-string">&quot;e1&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;e2&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-243"></a><span>        </span><a href="Grin.GExp.html#Case"><span class="hs-identifier hs-var">Case</span></a><span> </span><span class="hs-string">&quot;e2&quot;</span><span>
</span><a name="line-244"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e3&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-245"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Int&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e3&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;e11&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-246"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;e11&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Nil&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-248"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Nil&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;e12&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-249"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;e12&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Cons&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e4&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;e5&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-251"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Val"><span class="hs-identifier hs-var">Val</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#VNode"><span class="hs-identifier hs-var">VNode</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Node"><span class="hs-identifier hs-var">Node</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-string">&quot;Cons&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e4&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;e5&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;e13&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-252"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;e13&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-string">&quot;upto&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e6&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;e7&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-254"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;upto&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e6&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;e7&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;e8&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-255"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Update"><span class="hs-identifier hs-var">Update</span></a><span> </span><span class="hs-string">&quot;e1&quot;</span><span> </span><span class="hs-string">&quot;e8&quot;</span><span class="hs-special">)</span><span> </span><a href="Grin.Exp.html#BUnit"><span class="hs-identifier hs-var">BUnit</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-256"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;e8&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>          </span><span class="hs-special">,</span><span> </span><a href="Grin.GExp.html#Alt"><span class="hs-identifier hs-var">Alt</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#NodePat"><span class="hs-identifier hs-var">NodePat</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Tag"><span class="hs-identifier hs-var">Tag</span></a><span> </span><a href="Grin.Value.html#F"><span class="hs-identifier hs-var">F</span></a><span> </span><span class="hs-string">&quot;sum&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e9&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-258"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-string">&quot;sum&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;e9&quot;</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Grin.Exp.html#BVar"><span class="hs-identifier hs-var">BVar</span></a><span> </span><span class="hs-string">&quot;e10&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-259"></a><span>                </span><a href="Grin.GExp.html#Bind"><span class="hs-identifier hs-var">Bind</span></a><span> </span><span class="hs-special">(</span><a href="Grin.GExp.html#Update"><span class="hs-identifier hs-var">Update</span></a><span> </span><span class="hs-string">&quot;e1&quot;</span><span> </span><span class="hs-string">&quot;e10&quot;</span><span class="hs-special">)</span><span> </span><a href="Grin.Exp.html#BUnit"><span class="hs-identifier hs-var">BUnit</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-260"></a><span>                </span><a href="Grin.GExp.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><span class="hs-special">(</span><a href="Grin.Value.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-string">&quot;e10&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-261"></a><span>          </span><span class="hs-special">]</span><span>
</span><a name="line-262"></a><span>    </span><span class="hs-special">]</span><span>
</span><a name="line-263"></a></pre></body></html>